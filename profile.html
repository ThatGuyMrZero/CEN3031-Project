
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" href="styles.css">
</head>


<style>
    #profileMenu {
        display: flex;
        flex-flow: column nowrap;
    }

    /*TODO: Try to make #colorOptions grow to max width*/
    #colorOptions {
        display: flex;
        flex-flow: row nowrap;
        align-items: center;
    }

    #colorSelection {
        display: flex;
        flex-flow: column nowrap;
    }

    #colorMenu {
        display: flex;
        flex-flow: row wrap;
        justify-content: center;
    }

    #colorMenu button {
        margin: 10px 5px;
    }

    /* Dropdown Content (Hidden by Default) */
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #808080;
        min-width: 160px;
        box-shadow: 8px 16px #00000033;
        z-index: 1;
    }

    /* Links inside the dropdown */
    .dropdown-content p {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
    }

    /* Change color of dropdown links on hover */
    .dropdown-content button:hover {
        background-color: #a8a8a8;
        cursor: pointer;
    }

    /* Show the dropdown menu on hover */
    .dropdown:hover .dropdown-content {
        display: block;
    }

    .colorItem {
        align-content: space-between;
    }

</style>


<body>

<div class="section">

    <div id="profileMenu" class="section">

        <div id="picture-selector">

        </div>

        <div id="colorOptions">

            <div class="dropdown">
                <button id="dropdown-header" class="button"></button>
                <div class="dropdown-content">
                    <button onclick="pickType('solid')">Solid</button>
                    <button onclick="pickType('linear-gradient')">Linear Gradient</button>
                    <button onclick="pickType('radial-gradient')">Radial Gradient</button>
                    <button onclick="pickType('repeating-linear-gradient')">Repeating Linear Gradient</button>
                </div>
            </div>

            <br>

            <div id="colorSelection" class="menu">

                <div class="colorItem" id="itemPrimary">

                    <label for="color-primary">Primary color: </label>
                    <input type="color" value="#808890" id="color-primary">
                    <div class="width-selector" id="selectorWidthPrimary">
                        <label for="widthPrimary">Width:</label>
                        <input type="range" id="widthPrimary" name="widthPrimary" min="0" max="100" />
                        <output id="width-output-primary"></output>
                    </div>

                </div>

                <br>

                <div class="colorItem" id="itemSecondary">

                    <label for="color-secondary">Secondary color: </label>
                    <input type="color" value="#908880" id="color-secondary">
                    <div class="width-selector" id="selectorWidthSecondary">
                        <label for="widthSecondary">Width:</label>
                        <input type="range" id="widthSecondary" name="widthSecondary" min="0" max="100" />
                        <output id="width-output-secondary"></output>
                    </div>

                </div>

                <br>

                <div class="colorItem" id="itemTertiary">

                    <div>
                    <label for="color-tertiary">Tertiary color: </label>
                    <input type="color" value="#38a050" id="color-tertiary">
                    </div>

                    <div class="width-selector" id="selectorWidthTertiary">
                        <label for="widthTertiary">Width:</label>
                        <input type="range" id="widthTertiary" name="widthTertiary" min="0" max="100" />
                        <output id="width-output-tertiary"></output>
                    </div>

                </div>

            </div>

            <div class="selector">
                <div class="angle-selector" id="selectorAngle">
                    <label for="angle">Angle:</label>
                    <input type="range" id="angle" name="angle" min="0" max="360" />
                    <output id="angle-output"></output>
                </div>
            </div>
        </div>

        <br>

            <div id="colorMenu" >
                <button onclick="colorDefault()">Default</button>
            </div>


    </div>

    <div class="section">
        <h3>Back to:</h3>
        <button onclick="window.location.href='/'">Menu</button>
        <button onclick=playGame()>Game</button>
    </div>

</div>

</body>

<script src="script.js"></script>

<script>

    function changeDisplay(type = 'solid') {

        const allDisplays = ['itemPrimary', 'itemSecondary', 'itemTertiary', 'selectorAngle'];
        let nullDisplays = []

        if ( type === 'solid' ) {
            // TODO: Figure out why '#selectorWidthPrimary' isn't having display set to 'none'.
            nullDisplays = ['itemSecondary', 'itemTertiary', 'selectorAngle', 'selectorWidthPrimary'];
        }
        else if ( type === 'linear-gradient' ) {

            nullDisplays = [];
        }
        else if ( type === 'radial-gradient' ) {

            nullDisplays = ['selectorAngle'];
        }
        else if ( type === 'repeating-linear-gradient' ) {

            nullDisplays = [];
        }

        allDisplays.forEach( (display) => {
            ( nullDisplays.includes(display) ) ?
                document.querySelector('#' + display).style.display = 'none' :
                document.querySelector('#' + display).style.display = 'flex'
        });

    }

    function pickType(bgType = 'solid') {

        // This does not work if nested inside 'changeDisplay()'.
        // This copy is necessary to update on button click. I'm not sure why, as the page eventually gets reloaded.
        sessionStorage.setItem('background-type', bgType)
        document.querySelector("#dropdown-header").innerHTML = "Background Type:<br>" + bgType;

        // The promise doesn't have an effect, but it could, I guess.
        // TODO: Figure out why this doesn't update the background, as 'setColors()' runs 'location.reload()'.
        changeDisplay(bgType).then(setColors());
    }

    function setColors() {

        sessionStorage.setItem('default', 'false');

        location.reload();
    }

    const pictureSelector = document.querySelector('#pictureSelector');


    // This copy is necessary to update on initial page load, but does not work on button press.
    const backgroundType = sessionStorage.getItem('background-type');
    document.querySelector("#dropdown-header").innerHTML = "Background Type:<br>" + backgroundType;
    // TODO: Figure out why this line causes color selector inputs to default.
    changeDisplay(backgroundType);

    const primary = document.querySelector('#color-primary');
    const secondary = document.querySelector('#color-secondary');
    const tertiary = document.querySelector('#color-tertiary');

    primary.value = sessionStorage.getItem('color-primary');
    secondary.value = sessionStorage.getItem('color-secondary');
    tertiary.value = sessionStorage.getItem('color-tertiary');

    primary.addEventListener('change', () => {
        sessionStorage.setItem('color-primary', primary.value);
        setColors();
    });
    secondary.addEventListener('change', () => {
        sessionStorage.setItem('color-secondary', secondary.value);
        setColors();
    });
    tertiary.addEventListener('change', () => {
        sessionStorage.setItem('color-tertiary', tertiary.value);
        setColors();
    });



    const angleInput = document.querySelector("#angle");

    angleInput.value = sessionStorage.getItem('angle');

    const angleOutput = document.querySelector("#angle-output");

    angleOutput.textContent = angleInput.value + "\u00B0";

    angleInput.addEventListener("change", (event) => {
        sessionStorage.setItem('angle', event.target.value);
        setColors();
    });


    const widthInputPrimary = document.querySelector("#widthPrimary");
    const widthInputSecondary = document.querySelector("#widthSecondary");
    const widthInputTertiary = document.querySelector("#widthTertiary");

    widthInputPrimary.value = sessionStorage.getItem('width-primary');
    widthInputSecondary.value = sessionStorage.getItem('width-secondary');
    widthInputTertiary.value = sessionStorage.getItem('width-tertiary');

    const widthOutputPrimary = document.querySelector("#width-output-primary");
    const widthOutputSecondary = document.querySelector("#width-output-secondary");
    const widthOutputTertiary = document.querySelector("#width-output-tertiary");

    widthOutputPrimary.textContent = widthInputPrimary.value + "%";
    widthOutputSecondary.textContent = widthInputSecondary.value + "%";
    widthOutputTertiary.textContent = widthInputTertiary.value + "%";

    // TODO: refactor every reference to colors with 'color1', 'color2', etc, for use with arrays.

    widthInputPrimary.addEventListener("change", (event) => {
        sessionStorage.setItem('width-primary', event.target.value);
        setColors();
    });
    widthInputSecondary.addEventListener("change", (event) => {
        sessionStorage.setItem('width-secondary', event.target.value);
        setColors();
    });
    widthInputTertiary.addEventListener("change", (event) => {
        sessionStorage.setItem('width-tertiary', event.target.value);
        setColors();
    });

</script>


</html>